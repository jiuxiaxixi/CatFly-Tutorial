# PHY-Layer Frame Structure (PPDU)

![IEEE 802.15.4 Frame Format - PHY-Layer Frame Structure (PPDU)](..\附件\image-20191222155613983.png)

##  Synchronization Header (SHR)

The SHR consists of a four-octet preamble field (all zero), followed by a single byte start-offrame delimiter (SFD) which has the predefined value 0xA7. During transmit, the SHR is automatically generated by the AT86RF231, thus the Frame Buffer shall contain PHR and PSDU only. 

The transmission of the SHR requires 160 µs (10 symbols). As the SPI data rate is normally higher than the over-air data rate, this allows the microcontroller to initiate a transmission without having transferred the full frame data already. Instead it is possible to subsequently write the frame content. 

During frame reception, the SHR is used for synchronization purposes. The matching SFD determines the beginning of the PHR and the following PSDU payload data.

## PHY Header (PHR)

The PHY header is a single octet following the SHR. The least significant 7 bits denote the frame length of the following PSDU, while the most significant bit of that octet is reserved, and shall be set to 0 for IEEE 802.15.4 compliant frames. 

On receive the PHR is returned as the first octet during Frame Buffer read access. Even though the standard only defines frame lengths ≤127 bytes, AT86RF231 is able to transmit and receive frame length values >127. For IEEE 802.15.4 compliant operation bit 7 has to be masked by SW. The reception of a valid PHR is signaled by an interrupt IRQ_2 (RX_START). 

On transmit the PHR is to be supplied by the microcontroller during Frame Buffer write access as the first octet.

## PHY Payload (PHY Service Data Unit, PSDU)

The PSDU has a variable length between 0 and aMaxPHYPacketSize (127, maximum PSDU size in octets) whereas the last two octets are used for the Frame Check Sequence (FCS). The length of the PSDU is signaled by the frame length field (PHR). The PSDU contains the MAC Protocol Layer Data Unit (MPDU).

| Frame Length Value    | Frame Length Value Payload |
| --------------------- | -------------------------- |
| 0 - 4                 | Reserved                   |
| 5                     | MPDU (Acknowledgement)     |
| 6 - 8                 | Reserved                   |
| 9 - aMaxPHYPacketSize | MPDU                       |



